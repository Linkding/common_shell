### 存储引擎  

* 存储引擎指定了表的类型，即如何存储和索引数据、是否支持事物等，同时存储引擎也决定了表在计算机中的存储方式

存储引擎|作用
-----|-----
MyISAM|不支持事物、不支持外键，因此访问速度快，对事物完整性没有要求并且以访问为主的应用适合
InnoDB|支持事物，提交、回滚、崩溃恢复能力等，比上边一种会更加耗费磁盘空间，需要频繁更新、删除，对事物完整性要求高，需要实现并发控制的应用适合
MEMORY|使用内存来存储数据，因此访问速度快，但是安全上没有保障，涉及数据小、需要快速访问的应用适合

存储引擎参数|意义
-----|-----
Support|是否支持该存储引擎，yes/no，default表示默认
Comment|关于存储引擎的评论
Transactions|是否支持事务
XA|存储引擎支持的分布式是否符合XA规范
Savepoints|是否支持事务处理中的保存点

* Mysql支持事务的存储引擎：InnoDB和BDB;

* InnoDB存储引擎事务主要通过UNDO日志和REDO日志实现;支持ACID事务、行级锁和高并发;

* 事务：  
多用户访问同一份数据，一个用户在更改数据的过程中其他用户同时发出更改请求，保证数据库的更新从一个一致状态更改为另外一个一致性状态;

* 事务的特性
一个事务从开始到提交前所做的任何改变都是不可见的，事务只能看到已经、提交事物所做的改变
特性|意义
-----|------
原子性|对事务所进行的数据修改等操作只能完全提交或者完全回滚
一致性|数据变更必须应用与事务的修改，保证数据完整性
隔离性|当前事务不会查看由另一个并发事务正在修改数据
持久性|事务完成，所做的修改对数据影响是永久，重启故障数据可恢复

* REDO日志：  
事务执行时将执行的事务日志写入日志文件；  
1.每条sql语句进行数据库更新，先将REDO写到日志缓冲区，当客户端执行COMMIT命令提交时，日志缓冲区的内容江北刷新到磁盘；  
2.刷新方式或者时间间隔通过参数innodb_flush_log_at_trx_commit控制；  
3.对应磁盘上ib_logfileN文件

* UNDO日志：  
事务异常时的数据回滚；
不存在单独的UNDO日志文件，所有的UNDO日志都放在表空间对应的.ibd；

* Mysql事务隔离级别

级别|意义|备注
-----|------|------
READ-UNCOMMITTED|读取未提交内容|
READ-COMMITTED|读取提交内容|大多数数据库默认级别，不是Mysql默认；
REPEATABLE-READ|可重读|Mysql默认；  确保同一事务的多个实例在并发读取数据时会看到同样数据行；
Serializable|可串行化|强制事务排序，在每个可读数据行上加上共享锁实现

* InnoDB和Falcon通过多版本并发控制MVCC机制解决幻读问题  
InnoDB的MVCC机制：  
为每个数据行增加两个隐含值（行创建时间&过期时间）实现；

* InnoDB锁机制：  
为保证数据一致性，要对并发操作进行控制，使用行锁机制；

* 锁类型：  
1.共享锁  
2.排他锁  
3.意向锁

* 锁粒度：  

锁|意义
-----|-----
表锁|管理锁的开销最小、允许并发量最小  
行锁|支持最大并发
