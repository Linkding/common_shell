[TOC]

# 1 主从同步用法
## 1.1 主从方式
- 一主一从
- 一主多从

## 1.2 概述说明
- 主从结构的目的
    - 纯粹的冗余备份
    - 提升读性能

- Redis主从同步是异步进行的，主从同步不影响主逻辑，不会降低redis的处理性能

- 主从架构中，可以考虑关闭主服务器的数据持续化功能，只让从服务器进行持续化

- 主从架构中，从服务器通常被设置为只读模式，避免从服务器的数据被误修改

# 2 主从同步原理
- 从服务器会向主服务器发出SYNC指令，当主服务器接到此命令后，就会调用BGSAVE指令来创建一个子进程专门进行数据持久化工作，也就是将主服务器的数据写入RDB文件中。在数据持久化期间，主服务器将执行的写指令都缓存在内存中。

- 在BGSAVE指令执行完成后，主服务器会将持久化好的RDB文件发送给从服务器，从服务器接到此文件后会将其存储到磁盘上，然后再将其读取到内存中。这个动作完成后，主服务器会将这段时间缓存的写指令再以redis协议的格式发送给从服务器。

- 即使有多个从服务器同时发来SYNC指令，主服务器也只会执行一次BGSAVE，然后把持久化好的RDB文件发给多个下游。